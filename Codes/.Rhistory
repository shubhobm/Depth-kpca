sm = matrix(img.mat[i,], nrow=a, byrow=F)
plot(imagematrix(sm))
plot(imagematrix(sm))
plot(imagematrix(sm))
par(defaultPar)
a = 192; b = 168
img.mat = matrix(0, nrow=3*n, ncol=a*b)
ns=ceiling(.5*a)
set.seed(12062015)
img.list = list.files("../CroppedYale/yaleB01")
for(i in 4:(n+3)){
t = read.pnm(paste0("../CroppedYale/yaleB01/",img.list[[i]]))
t = imagematrix(getChannels(t))
t = resize(t, w=a, h=b)
# speckle noise for sample 10
if(i==10){
samps = sample(1:min(a,b), 2*ns, replace=T)
t1 = t
t[samps[1:ns], samps[(ns+1):(2*ns)]] = sample(c(0,1), ns^2, replace=T)
}
img.mat[i-3,] = as.numeric(t)
}
img.mat0 = img.mat
img.mat0[7,] = as.numeric(t1)
img.list = list.files("../CroppedYale/yaleB02")
for(i in 4:(n+3)){
t = read.pnm(paste0("../CroppedYale/yaleB02/",img.list[[i]]))
t = imagematrix(getChannels(t))
t = resize(t, w=a, h=b)
# speckle noise for sample 10
if(i==10){
samps = sample(1:min(a,b), 2*ns, replace=T)
t1 = t
t[samps[1:ns], samps[(ns+1):(2*ns)]] = sample(c(0,1), ns^2, replace=T)
}
img.mat[n+i-3,] = as.numeric(t)
}
img.mat0[n+7,] = as.numeric(t1)
img.list = list.files("../CroppedYale/yaleB28")
for(i in 4:(n+3)){
t = read.pnm(paste0("../CroppedYale/yaleB28/",img.list[[i]]))
t = imagematrix(getChannels(t))
t = resize(t, w=a, h=b)
# speckle noise for sample 10
if(i==10){
samps = sample(1:min(a,b), 2*ns, replace=T)
t1 = t
t[samps[1:ns], samps[(ns+1):(2*ns)]] = sample(c(0,1), ns^2, replace=T)
}
img.mat[2*n+i-3,] = as.numeric(t)
}
img.mat0[2*n+7,] = as.numeric(t1)
i = 7 # change i to 7, 27 or 47 for 3 different persons
sm = matrix(img.mat[i,], nrow=a, byrow=F)
plot(imagematrix(sm))
(k = rbfdot(- 1/mean(log(kernelMatrix(rbfdot(.0005), img.mat))/.0005)))
mod.kpc = list()
mod.kpcLoc = list()
mod.kpcDep = list()
for(nf in 1:10){
mod.kpc[[nf]] <- kpca(img.mat, features=nf, kernel=k)
mod.kpcLoc[[nf]] <- kpcaLocantore(img.mat, features=nf, kernel=k)
mod.kpcDep[[nf]] <- kpcaLocantore(img.mat, features=nf, is.depth=TRUE, kernel=k)
}
cols = c(rep("red",n), rep("blue",n), rep("green",n))
par(mfrow=c(1,3))
plot(rotated(mod.kpc[[2]]), col=cols, pch=19)
plot(mod.kpcLoc[[2]]$rotated, col=cols, pch=19)
plot(mod.kpcDep[[2]]$rotated, col=cols, pch=19)
par(mfrow=c(1,1))
defaultPar = par()
par(mfcol=c(3,7), mai=rep(0,4))
for(nf in 2*(1:5)){
s = reconKwok(mod.kpc[[nf]], img.mat[i:(i+1),], k=5)
sm = matrix(s[1,], nrow=a, byrow=F)
plot(imagematrix(sm))
s = reconKwok(mod.kpcLoc[[nf]], img.mat[i:(i+1),], k=5)
sm = matrix(s[1,], nrow=a, byrow=F)
plot(imagematrix(sm))
s = reconKwok(mod.kpcDep[[nf]], img.mat[i:(i+1),], k=5)
sm = matrix(s[1,], nrow=a, byrow=F)
plot(imagematrix(sm))
}
sm = matrix(img.mat0[i,], nrow=a, byrow=F)
plot(imagematrix(sm))
plot(imagematrix(sm))
plot(imagematrix(sm))
sm = matrix(img.mat[i,], nrow=a, byrow=F)
plot(imagematrix(sm))
plot(imagematrix(sm))
plot(imagematrix(sm))
par(defaultPar)
i = 27 # change i to 7, 27 or 47 for 3 different persons
defaultPar = par()
par(mfcol=c(3,7), mai=rep(0,4))
for(nf in 2*(1:5)){
s = reconKwok(mod.kpc[[nf]], img.mat[i:(i+1),], k=5)
sm = matrix(s[1,], nrow=a, byrow=F)
plot(imagematrix(sm))
s = reconKwok(mod.kpcLoc[[nf]], img.mat[i:(i+1),], k=5)
sm = matrix(s[1,], nrow=a, byrow=F)
plot(imagematrix(sm))
s = reconKwok(mod.kpcDep[[nf]], img.mat[i:(i+1),], k=5)
sm = matrix(s[1,], nrow=a, byrow=F)
plot(imagematrix(sm))
}
sm = matrix(img.mat0[i,], nrow=a, byrow=F)
plot(imagematrix(sm))
plot(imagematrix(sm))
plot(imagematrix(sm))
sm = matrix(img.mat[i,], nrow=a, byrow=F)
plot(imagematrix(sm))
plot(imagematrix(sm))
plot(imagematrix(sm))
par(defaultPar)
i = 47 # change i to 7, 27 or 47 for 3 different persons
defaultPar = par()
par(mfcol=c(3,7), mai=rep(0,4))
for(nf in 2*(1:5)){
s = reconKwok(mod.kpc[[nf]], img.mat[i:(i+1),], k=5)
sm = matrix(s[1,], nrow=a, byrow=F)
plot(imagematrix(sm))
s = reconKwok(mod.kpcLoc[[nf]], img.mat[i:(i+1),], k=5)
sm = matrix(s[1,], nrow=a, byrow=F)
plot(imagematrix(sm))
s = reconKwok(mod.kpcDep[[nf]], img.mat[i:(i+1),], k=5)
sm = matrix(s[1,], nrow=a, byrow=F)
plot(imagematrix(sm))
}
sm = matrix(img.mat0[i,], nrow=a, byrow=F)
plot(imagematrix(sm))
plot(imagematrix(sm))
plot(imagematrix(sm))
sm = matrix(img.mat[i,], nrow=a, byrow=F)
plot(imagematrix(sm))
plot(imagematrix(sm))
plot(imagematrix(sm))
par(defaultPar)
defaultPar = par()
par(mfcol=c(3,7), mai=rep(0,4))
for(i in c(2,27,47)){
sm = matrix(img.mat0[i,], nrow=a, byrow=F)
plot(imagematrix(sm))
sm = matrix(img.mat[i,], nrow=a, byrow=F)
plot(imagematrix(sm))
}
par(defaultPar)
defaultPar = par()
par(mfcol=c(3,2), mai=rep(0,4))
for(i in c(2,27,47)){
sm = matrix(img.mat0[i,], nrow=a, byrow=F)
plot(imagematrix(sm))
sm = matrix(img.mat[i,], nrow=a, byrow=F)
plot(imagematrix(sm))
}
par(defaultPar)
defaultPar = par()
par(mfcol=c(2,3), mai=rep(0,4))
for(i in c(2,27,47)){
sm = matrix(img.mat0[i,], nrow=a, byrow=F)
plot(imagematrix(sm))
sm = matrix(img.mat[i,], nrow=a, byrow=F)
plot(imagematrix(sm))
}
par(defaultPar)
defaultPar = par()
par(mfcol=c(2,3), mai=rep(0,4))
for(i in c(7,27,47)){
sm = matrix(img.mat0[i,], nrow=a, byrow=F)
plot(imagematrix(sm))
sm = matrix(img.mat[i,], nrow=a, byrow=F)
plot(imagematrix(sm))
}
par(defaultPar)
defaultPar = par()
par(mfcol=c(2,3), mai=rep(0.1,4))
for(i in c(7,27,47)){
sm = matrix(img.mat0[i,], nrow=a, byrow=F)
plot(imagematrix(sm))
sm = matrix(img.mat[i,], nrow=a, byrow=F)
plot(imagematrix(sm))
}
par(defaultPar)
defaultPar = par()
par(mfcol=c(3,5), mai=rep(0,4))
for(nf in 2*(1:5)){
s = reconKwok(mod.kpc[[nf]], img.mat[i:(i+1),], k=5)
sm = matrix(s[1,], nrow=a, byrow=F)
plot(imagematrix(sm))
s = reconKwok(mod.kpcLoc[[nf]], img.mat[i:(i+1),], k=5)
sm = matrix(s[1,], nrow=a, byrow=F)
plot(imagematrix(sm))
s = reconKwok(mod.kpcDep[[nf]], img.mat[i:(i+1),], k=5)
sm = matrix(s[1,], nrow=a, byrow=F)
plot(imagematrix(sm))
}
par(defaultPar)
defaultPar = par()
par(mfcol=c(3,5), mai=rep(0.1,4))
for(nf in 2*(1:5)){
s = reconKwok(mod.kpc[[nf]], img.mat[i:(i+1),], k=5)
sm = matrix(s[1,], nrow=a, byrow=F)
plot(imagematrix(sm))
s = reconKwok(mod.kpcLoc[[nf]], img.mat[i:(i+1),], k=5)
sm = matrix(s[1,], nrow=a, byrow=F)
plot(imagematrix(sm))
s = reconKwok(mod.kpcDep[[nf]], img.mat[i:(i+1),], k=5)
sm = matrix(s[1,], nrow=a, byrow=F)
plot(imagematrix(sm))
}
par(defaultPar)
i = 7
defaultPar = par()
par(mfcol=c(3,5), mai=rep(0.1,4))
for(nf in 2*(1:5)){
s = reconKwok(mod.kpc[[nf]], img.mat[i:(i+1),], k=5)
sm = matrix(s[1,], nrow=a, byrow=F)
plot(imagematrix(sm))
s = reconKwok(mod.kpcLoc[[nf]], img.mat[i:(i+1),], k=5)
sm = matrix(s[1,], nrow=a, byrow=F)
plot(imagematrix(sm))
s = reconKwok(mod.kpcDep[[nf]], img.mat[i:(i+1),], k=5)
sm = matrix(s[1,], nrow=a, byrow=F)
plot(imagematrix(sm))
}
par(defaultPar)
i = 27
defaultPar = par()
par(mfcol=c(3,5), mai=rep(0.1,4))
for(nf in 2*(1:5)){
s = reconKwok(mod.kpc[[nf]], img.mat[i:(i+1),], k=5)
sm = matrix(s[1,], nrow=a, byrow=F)
plot(imagematrix(sm))
s = reconKwok(mod.kpcLoc[[nf]], img.mat[i:(i+1),], k=5)
sm = matrix(s[1,], nrow=a, byrow=F)
plot(imagematrix(sm))
s = reconKwok(mod.kpcDep[[nf]], img.mat[i:(i+1),], k=5)
sm = matrix(s[1,], nrow=a, byrow=F)
plot(imagematrix(sm))
}
par(defaultPar)
defaultPar = par()
par(mfrow=c(3,2), mai=rep(0.1,4))
for(i in c(7,27,47)){
sm = matrix(img.mat0[i,], nrow=a, byrow=F)
plot(imagematrix(sm))
sm = matrix(img.mat[i,], nrow=a, byrow=F)
plot(imagematrix(sm))
}
par(defaultPar)
i = 27
defaultPar = par()
par(mfrow=c(5,3), mai=rep(0.1,4))
for(nf in 2*(1:5)){
s = reconKwok(mod.kpc[[nf]], img.mat[i:(i+1),], k=5)
sm = matrix(s[1,], nrow=a, byrow=F)
plot(imagematrix(sm))
s = reconKwok(mod.kpcLoc[[nf]], img.mat[i:(i+1),], k=5)
sm = matrix(s[1,], nrow=a, byrow=F)
plot(imagematrix(sm))
s = reconKwok(mod.kpcDep[[nf]], img.mat[i:(i+1),], k=5)
sm = matrix(s[1,], nrow=a, byrow=F)
plot(imagematrix(sm))
}
par(defaultPar)
i = 7
defaultPar = par()
par(mfrow=c(5,3), mai=rep(0.1,4))
for(nf in 2*(1:5)){
s = reconKwok(mod.kpc[[nf]], img.mat[i:(i+1),], k=5)
sm = matrix(s[1,], nrow=a, byrow=F)
plot(imagematrix(sm))
s = reconKwok(mod.kpcLoc[[nf]], img.mat[i:(i+1),], k=5)
sm = matrix(s[1,], nrow=a, byrow=F)
plot(imagematrix(sm))
s = reconKwok(mod.kpcDep[[nf]], img.mat[i:(i+1),], k=5)
sm = matrix(s[1,], nrow=a, byrow=F)
plot(imagematrix(sm))
}
par(defaultPar)
i = 47
defaultPar = par()
par(mfrow=c(5,3), mai=rep(0.1,4))
for(nf in 2*(1:5)){
s = reconKwok(mod.kpc[[nf]], img.mat[i:(i+1),], k=5)
sm = matrix(s[1,], nrow=a, byrow=F)
plot(imagematrix(sm))
s = reconKwok(mod.kpcLoc[[nf]], img.mat[i:(i+1),], k=5)
sm = matrix(s[1,], nrow=a, byrow=F)
plot(imagematrix(sm))
s = reconKwok(mod.kpcDep[[nf]], img.mat[i:(i+1),], k=5)
sm = matrix(s[1,], nrow=a, byrow=F)
plot(imagematrix(sm))
}
par(defaultPar)
train <- read.csv("C:/Users/Subho/Downloads/train.csv")
View(train)
summary(train$label)
train1 = train[which(train$label<2),]
dim(train1)
max(train$pixel1)
max(train$pixel2)
View(train1)
max(train1)
train1[,-1] = train1[,-1]/255
plot(imagematrix(train1[1,]))
train1[1,]
plot(imagematrix(matrix(train1[1,], nrow=28, byrow=T)))
plot(imagematrix(matrix(train1[1,-1], nrow=28, byrow=T)))
z=matrix(train1[1,-1], nrow=28, byrow=T)
View(z)
plot(imagematrix(z))
library(kernlab)
library(pixmap)
library(ripa)
library(EBImage)
library(FNN)
source("misc_functions1.R")
plot(imagematrix(z))
sm = matrix(img.mat0[i,], nrow=a, byrow=F)
View(sm)
View(z)
class(z)
class(sm)
plot(imagematrix(sm))
plot(imagematrix(sm[1:28, 1:28]))
plot(imagematrix(z[1:28, 1:28]))
plot(z)
plot.imagematrix
imagematrix(z)
min(z)
summary(z)
z=matrix(as.numeric(train1[1,-1]), nrow=28, byrow=T)
imagematrix(z)
plot(imagematrix(z))
z=matrix(as.numeric(train1[2,-1]), nrow=28, byrow=T)
plot(imagematrix(z))
z=matrix(as.numeric(train1[3,-1]), nrow=28, byrow=T)
plot(imagematrix(z))
z=matrix(as.numeric(train1[31,-1]), nrow=28, byrow=T)
plot(imagematrix(z))
dim(train1)
img.mat=train1[1:100,]
(k = rbfdot(- 1/mean(log(kernelMatrix(rbfdot(.0005), img.mat))/.0005)))
dim(img.mat)
class(img.mat)
img.mat=as.matrix(train1[1:100,])
(k = rbfdot(- 1/mean(log(kernelMatrix(rbfdot(.0005), img.mat))/.0005)))
mod.kpc = list()
mod.kpcLoc = list()
mod.kpcDep = list()
for(nf in 1:10){
mod.kpc[[nf]] <- kpca(img.mat, features=nf, kernel=k)
mod.kpcLoc[[nf]] <- kpcaLocantore(img.mat, features=nf, kernel=k)
mod.kpcDep[[nf]] <- kpcaLocantore(img.mat, features=nf, is.depth=TRUE, kernel=k)
}
defaultPar = par()
par(mfrow=c(3,2), mai=rep(0.1,4))
for(i in c(7,27,47)){
sm = matrix(img.mat0[i,], nrow=a, byrow=F)
plot(imagematrix(sm))
sm = matrix(img.mat[i,], nrow=a, byrow=F)
plot(imagematrix(sm))
}
par(defaultPar)
i = 47
a=28
defaultPar = par()
par(mfrow=c(5,3), mai=rep(0.1,4))
for(nf in 2*(1:5)){
s = reconKwok(mod.kpc[[nf]], img.mat[i:(i+1),], k=5)
sm = matrix(s[1,], nrow=a, byrow=F)
plot(imagematrix(sm))
s = reconKwok(mod.kpcLoc[[nf]], img.mat[i:(i+1),], k=5)
sm = matrix(s[1,], nrow=a, byrow=F)
plot(imagematrix(sm))
s = reconKwok(mod.kpcDep[[nf]], img.mat[i:(i+1),], k=5)
sm = matrix(s[1,], nrow=a, byrow=F)
plot(imagematrix(sm))
}
par(defaultPar)
img.mat[47,1]
i = 7
a=28
defaultPar = par()
par(mfrow=c(5,3), mai=rep(0.1,4))
for(nf in 2*(1:5)){
s = reconKwok(mod.kpc[[nf]], img.mat[i:(i+1),], k=5)
sm = matrix(s[1,], nrow=a, byrow=F)
plot(imagematrix(sm))
s = reconKwok(mod.kpcLoc[[nf]], img.mat[i:(i+1),], k=5)
sm = matrix(s[1,], nrow=a, byrow=F)
plot(imagematrix(sm))
s = reconKwok(mod.kpcDep[[nf]], img.mat[i:(i+1),], k=5)
sm = matrix(s[1,], nrow=a, byrow=F)
plot(imagematrix(sm))
}
par(defaultPar)
i = 17
a=28
defaultPar = par()
par(mfrow=c(5,3), mai=rep(0.1,4))
for(nf in 2*(1:5)){
s = reconKwok(mod.kpc[[nf]], img.mat[i:(i+1),], k=5)
sm = matrix(s[1,], nrow=a, byrow=F)
plot(imagematrix(sm))
s = reconKwok(mod.kpcLoc[[nf]], img.mat[i:(i+1),], k=5)
sm = matrix(s[1,], nrow=a, byrow=F)
plot(imagematrix(sm))
s = reconKwok(mod.kpcDep[[nf]], img.mat[i:(i+1),], k=5)
sm = matrix(s[1,], nrow=a, byrow=F)
plot(imagematrix(sm))
}
par(defaultPar)
img.mat[7,1]
img.mat[17,1]
i = 17
a=28
defaultPar = par()
par(mfrow=c(5,3), mai=rep(0.1,4))
for(nf in 2*(1:5)){
s = reconKwok(mod.kpc[[nf]], img.mat[i:(i+1),], k=20)
sm = matrix(s[1,], nrow=a, byrow=F)
plot(imagematrix(sm))
s = reconKwok(mod.kpcLoc[[nf]], img.mat[i:(i+1),], k=20)
sm = matrix(s[1,], nrow=a, byrow=F)
plot(imagematrix(sm))
s = reconKwok(mod.kpcDep[[nf]], img.mat[i:(i+1),], k=20)
sm = matrix(s[1,], nrow=a, byrow=F)
plot(imagematrix(sm))
}
par(defaultPar)
train1 = train[which(train$label==3),]
img.mat=as.matrix(train1[1:100,])
i = 47 # change i to 7, 27 or 47 for 3 different persons
sm = matrix(img.mat[i,], nrow=28, byrow=F)
plot(imagematrix(sm))
i = 47 # change i to 7, 27 or 47 for 3 different persons
sm = matrix(img.mat[i,-1], nrow=28, byrow=F)
plot(imagematrix(sm))
(k = rbfdot(- 1/mean(log(kernelMatrix(rbfdot(.0005), img.mat))/.0005)))
i = 47 # change i to 7, 27 or 47 for 3 different persons
sm = matrix(img.mat[i,-1], nrow=28, byrow=T)
plot(imagematrix(sm))
mod.kpc = list()
mod.kpcLoc = list()
mod.kpcDep = list()
for(nf in 1:10){
mod.kpc[[nf]] <- kpca(img.mat, features=nf, kernel=k)
mod.kpcLoc[[nf]] <- kpcaLocantore(img.mat, features=nf, kernel=k)
mod.kpcDep[[nf]] <- kpcaLocantore(img.mat, features=nf, is.depth=TRUE, kernel=k)
}
dim(img.mat)
img.mat = img.mat[,-1]
mod.kpc = list()
mod.kpcLoc = list()
mod.kpcDep = list()
for(nf in 1:10){
mod.kpc[[nf]] <- kpca(img.mat, features=nf, kernel=k)
mod.kpcLoc[[nf]] <- kpcaLocantore(img.mat, features=nf, kernel=k)
mod.kpcDep[[nf]] <- kpcaLocantore(img.mat, features=nf, is.depth=TRUE, kernel=k)
}
dim(img.mat)
summary(img.mat)
img.mat = img.mat/155
img.mat = img.mat*155/255
mod.kpc = list()
mod.kpcLoc = list()
mod.kpcDep = list()
for(nf in 1:10){
mod.kpc[[nf]] <- kpca(img.mat, features=nf, kernel=k)
mod.kpcLoc[[nf]] <- kpcaLocantore(img.mat, features=nf, kernel=k)
mod.kpcDep[[nf]] <- kpcaLocantore(img.mat, features=nf, is.depth=TRUE, kernel=k)
}
sm = matrix(img.mat[i,], nrow=a, byrow=F)
plot(imagematrix(sm))
sm = matrix(img.mat[i,], nrow=a, byrow=T)
plot(imagematrix(sm))
digitdata = read.csv("C:/data/train_MNIST.csv")
dim(digitdata)
names(digitdata)
digitdata[,-1] = digitdata[,-1]/255
i = 31
sm = matrix(as.numeric(digitdata[i,01], nrow=28, byrow=T)
plot(imagematrix(sm))
sm = matrix(as.numeric(digitdata[i,01], nrow=28, byrow=T))
plot(imagematrix(sm))
sm = matrix(as.numeric(digitdata[i,-1], nrow=28, byrow=T))
plot(imagematrix(sm))
i = 31
sm = matrix(as.numeric(digitdata[i,-1], nrow=28, byrow=T))
plot(imagematrix(sm))
dev.off()
i = 31
sm = matrix(as.numeric(digitdata[i,-1], nrow=28, byrow=T))
plot(imagematrix(sm))
i = 1
sm = matrix(as.numeric(digitdata[i,-1], nrow=28, byrow=T))
plot(imagematrix(sm))
defaultPar = par()
par(mfcol=c(3,7), mai=rep(0,4))
for(nf in 2*(1:5)){
s = reconKwok(mod.kpc[[nf]], img.mat[i:(i+1),], k=2)
sm = matrix(s[1,], nrow=a, byrow=F)
plot(imagematrix(sm))
s = reconKwok(mod.kpcLoc[[nf]], img.mat[i:(i+1),], k=2)
sm = matrix(s[1,], nrow=a, byrow=F)
plot(imagematrix(sm))
s = reconKwok(mod.kpcDep[[nf]], img.mat[i:(i+1),], k=2)
sm = matrix(s[1,], nrow=a, byrow=F)
plot(imagematrix(sm))
}
